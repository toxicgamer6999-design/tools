
<!doctype html>
<html lang="en">
<head>
  <!-- ====== Basic SEO ====== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Free Online Image Compressor ‚Äî Fast, SEO-Friendly, AdSense Ready</title>
  <meta name="description" content="Compress and optimize images online with adjustable quality and optional resize. Fast in‚Äëbrowser processing, no uploads, privacy‚Äëfriendly. AdSense-ready layout." />
  <meta name="keywords" content="image compressor, compress image, reduce image size, webp converter, jpeg compressor, png to webp, online image optimizer" />
  <link rel="canonical" href="https://example.com/image-compressor" />
  <meta name="robots" content="index,follow" />

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Free Online Image Compressor ‚Äî Fast, SEO‚ÄëFriendly, AdSense Ready" />
  <meta property="og:description" content="Compress and optimize images with a quality slider, format conversion, and optional resize. 100% in your browser." />
  <meta property="og:url" content="https://example.com/image-compressor" />
  <meta property="og:image" content="https://example.com/og-image-compressor.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Image Compressor & Optimizer",
    "url": "https://example.com/image-compressor",
    "applicationCategory": "Multimedia",
    "operatingSystem": "Web",
    "description": "Compress images with a quality slider, convert formats (JPEG, PNG, WebP), and optionally resize ‚Äî all in the browser for privacy.",
    "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD"}
  }
  </script>

  <!-- ====== AdSense (Easy ID Injection) ====== -->
  <script>
    // üëâ Replace the values below with your own AdSense IDs.
    // client: your "ca-pub-XXXXXXXXXXXXXXX"; slots: your Ad Unit IDs
    window.ADSENSE = {
      client: "ca-pub-XXXXXXXXXXXXXXXX", // ‚Üê change me
      slotTopBanner: "0000000000",        // ‚Üê change me
      slotInfeed: "0000000001"            // ‚Üê change me
    };
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous" id="adsense-loader"></script>

  <!-- ====== Minimal, responsive, accessible CSS (no external CSS for performance) ====== -->
  <style>
    :root{
      --bg: #0b1020; --card:#101831; --muted:#aab2d5; --brand:#6aa3ff; --accent:#31d0aa; --text:#f5f7ff;
      --border: 1px solid #1e2a55;
    }
    html,body{height:100%}
    body{margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif; background:var(--bg); color:var(--text);}
    a{color:var(--brand)}
    .container{max-width:1080px; margin:0 auto; padding:24px;}
    header{display:flex; gap:16px; align-items:center; justify-content:space-between; flex-wrap:wrap}
    .logo{display:flex; align-items:center; gap:12px}
    .logo .dot{width:12px; height:12px; border-radius:50%; background:linear-gradient(135deg, var(--brand), var(--accent))}
    .title{font-size:clamp(20px, 4vw, 32px); font-weight:800; letter-spacing:.2px}
    .subtitle{color:var(--muted); max-width:64ch}

    .grid{display:grid; grid-template-columns:1fr; gap:18px}
    @media (min-width: 980px){ .grid{ grid-template-columns: 2fr 1fr } }

    .card{background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01)); border:var(--border); border-radius:18px; box-shadow: 0 6px 30px rgba(0,0,0,.25);}
    .card h2{font-size:20px; margin:0 0 8px 0}
    .card .content{padding:18px}

    .dropzone{border:2px dashed #2a3a75; background:#0d1530; padding:28px; border-radius:14px; text-align:center; outline:none; transition:.2s;}
    .dropzone.dragover{border-color:var(--accent); background:#0d1a36}
    .dropzone input{display:none}
    .btn{display:inline-flex; gap:8px; align-items:center; padding:10px 14px; background:linear-gradient(135deg, #3a66ff, #2bd8a6); border:none; border-radius:12px; color:white; font-weight:700; cursor:pointer}
    .btn.secondary{background:#15224b; color:#d8defa; border:var(--border)}

    .controls{display:grid; grid-template-columns:1fr; gap:12px}
    @media (min-width: 560px){ .controls{ grid-template-columns: repeat(2, 1fr) } }
    .field{display:flex; flex-direction:column; gap:6px}
    label{font-weight:600}
    input[type="number"], select, input[type="range"], input[type="text"]{
      background:#0d1530; border:var(--border); color:var(--text); border-radius:10px; padding:10px; width:100%; box-sizing:border-box
    }
    input[type="range"]{ padding:0; height:6px }
    .quality-display{font-variant-numeric: tabular-nums;}

    .results{display:grid; grid-template-columns:1fr; gap:16px; margin-top:8px}
    @media (min-width:720px){ .results{ grid-template-columns: repeat(2,1fr) } }
    .result{border:var(--border); border-radius:14px; overflow:hidden; background:#0d1530}
    .result header{display:flex; justify-content:space-between; padding:12px 14px; border-bottom:var(--border)}
    .result .stats{display:flex; gap:12px; color:var(--muted); font-size:12px}
    .preview{display:grid; grid-template-columns:1fr 1fr}
    .preview img{width:100%; height:260px; object-fit:contain; background:#0a0f23}
    .result .actions{display:flex; gap:10px; padding:12px 14px; border-top:var(--border)}

    /* Ad blocks */
    .ad{border:var(--border); border-radius:12px; background:#0d1530; padding:8px}
    .ad .label{font-size:12px; color:#6d79a8; text-transform:uppercase; letter-spacing:.15em; padding:6px 8px}

    footer{margin:36px 0 16px; color:#8792c2; font-size:13px; text-align:center}
    .sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
  </style>
</head>
<body>
  <div class="container">
    <header aria-label="Page header">
      <div class="logo" aria-label="Brand">
        <span class="dot" aria-hidden="true"></span>
        <div>
          <div class="title">Image Compressor & Optimizer</div>
          <p class="subtitle">Compress images with a quality slider, convert to JPEG/WebP/PNG, and optionally resize. Processing happens in your browser for privacy.</p>
        </div>
      </div>
    </header>

    <main class="grid" id="main">
      <!-- ====== Tool Card ====== -->
      <section class="card" id="tool" aria-label="Image compression tool">
        <div class="content">
          <h1 style="margin:0 0 14px">Free Online Image Compressor</h1>

          <div id="dropzone" class="dropzone" tabindex="0" role="button" aria-label="Upload images by clicking or dragging" aria-describedby="dropHelp">
            <p id="dropHelp">Drag & drop images here, or</p>
            <label class="btn" for="fileInput" aria-label="Choose files to upload"><span>Choose Files</span></label>
            <input id="fileInput" type="file" accept="image/*" multiple />
            <p class="subtitle" style="margin-top:8px">Supported: JPEG, PNG, WebP, GIF (first frame)</p>
          </div>

          <div class="controls" style="margin-top:18px" aria-label="Compression controls">
            <div class="field">
              <label for="quality">Quality <span class="quality-display" id="qualityValue">80%</span></label>
              <input id="quality" type="range" min="10" max="100" value="80" step="1" />
            </div>
            <div class="field">
              <label for="format">Output format</label>
              <select id="format">
                <option value="auto" selected>Auto (keep original)</option>
                <option value="image/jpeg">JPEG (.jpg)</option>
                <option value="image/webp">WebP (.webp)</option>
                <option value="image/png">PNG (.png)</option>
              </select>
            </div>
            <div class="field">
              <label for="width">Resize width (px) ‚Äî optional</label>
              <input id="width" type="number" inputmode="numeric" placeholder="e.g., 1600" />
            </div>
            <div class="field">
              <label for="height">Resize height (px) ‚Äî optional</label>
              <input id="height" type="number" inputmode="numeric" placeholder="Auto if left blank" />
            </div>
            <div class="field">
              <label for="lockRatio">
                <input id="lockRatio" type="checkbox" checked /> Maintain aspect ratio
              </label>
            </div>
            <div class="field">
              <button class="btn secondary" id="clearBtn" type="button">Clear Results</button>
            </div>
          </div>

          <div id="results" class="results" aria-live="polite" aria-busy="false"></div>
        </div>
      </section>

      <!-- ====== Ad / Info Column ====== -->
      <aside class="card" aria-label="Monetization and tips">
        <div class="content">
          <h2>Sponsored</h2>
          <div class="ad" id="ad-top">
            <div class="label">Ad</div>
            <!-- Top Responsive Ad Unit -->
            <ins class="adsbygoogle" style="display:block" data-ad-format="auto" data-full-width-responsive="true"></ins>
          </div>

          <h2 style="margin-top:18px">Tips for Best Results</h2>
          <ul>
            <li>JPEG/WebP are best for photos. PNG is best for graphics with transparency.</li>
            <li>Try 70‚Äì85% quality for a great balance of size and visual clarity.</li>
            <li>Resize large images to the exact display width for biggest savings.</li>
            <li>All processing happens locally in your browser ‚Äî your images never leave your device.</li>
          </ul>

          <div class="ad" id="ad-infeed" style="margin-top:14px">
            <div class="label">Ad</div>
            <!-- In-article/In-feed Ad Unit -->
            <ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-gw-3+1f-3d+2z" data-ad-client="" data-ad-slot=""></ins>
          </div>
        </div>
      </aside>
    </main>

    <footer>
      <p>¬© <span id="year"></span> Image Compressor. Built for speed, privacy, and SEO.</p>
    </footer>
  </div>

  <!-- ====== Core Logic ====== -->
  <script>
    const el = (id)=>document.getElementById(id);
    const results = el('results');
    const fileInput = el('fileInput');
    const qualityRange = el('quality');
    const qualityValue = el('qualityValue');
    const formatSelect = el('format');
    const widthInput = el('width');
    const heightInput = el('height');
    const lockRatio = el('lockRatio');
    const dropzone = el('dropzone');
    const clearBtn = el('clearBtn');

    document.getElementById('year').textContent = new Date().getFullYear();

    // ====== AdSense helper ‚Äî populates IDs and initializes ======
    (function initAds(){
      const client = window.ADSENSE?.client || '';
      const slotTop = window.ADSENSE?.slotTopBanner || '';
      const slotInfeed = window.ADSENSE?.slotInfeed || '';

      // Update loader src with your client (if changed in ADSENSE)
      const loader = document.getElementById('adsense-loader');
      if (loader && client && loader.src && loader.src.includes('client=ca-pub-')){
        const url = new URL(loader.src);
        url.searchParams.set('client', client);
        loader.src = url.toString();
      }

      const blocks = document.querySelectorAll('ins.adsbygoogle');
      blocks.forEach((ins)=>{
        if(!ins.dataset.adClient && client) ins.setAttribute('data-ad-client', client);
      });

      const top = document.querySelector('#ad-top ins.adsbygoogle');
      if (top && slotTop) top.setAttribute('data-ad-slot', slotTop);
      const infeed = document.querySelector('#ad-infeed ins.adsbygoogle');
      if (infeed && slotInfeed){ infeed.setAttribute('data-ad-slot', slotInfeed); }

      // Request ads (will only work on approved domains)
      try{ (adsbygoogle = window.adsbygoogle || []).push({}); }catch(e){}
      try{ (adsbygoogle = window.adsbygoogle || []).push({}); }catch(e){}
    })();

    // ====== Drag & Drop handling ======
    ['dragenter','dragover'].forEach(evt => dropzone.addEventListener(evt, (e)=>{
      e.preventDefault(); e.stopPropagation(); dropzone.classList.add('dragover');
    }));
    ['dragleave','drop'].forEach(evt => dropzone.addEventListener(evt, (e)=>{
      e.preventDefault(); e.stopPropagation(); dropzone.classList.remove('dragover');
    }));
    dropzone.addEventListener('drop', (e)=>{
      const files = [...e.dataTransfer.files].filter(f=>/image\/.+/.test(f.type));
      if (files.length) handleFiles(files);
    });

    dropzone.addEventListener('click', ()=> fileInput.click());
    fileInput.addEventListener('change', ()=> handleFiles([...fileInput.files]));

    qualityRange.addEventListener('input', ()=> qualityValue.textContent = qualityRange.value + '%');
    clearBtn.addEventListener('click', ()=>{ results.innerHTML=''; fileInput.value=''; });

    // ====== Image processing ======
    async function handleFiles(files){
      if(!files || !files.length) return;
      for(const file of files){
        try{
          const beforeBytes = file.size;
          const {img, naturalWidth, naturalHeight} = await loadImage(file);

          // Calculate target dimensions
          const target = calculateTargetSize(naturalWidth, naturalHeight);

          const outputType = resolveOutputType(file.type, formatSelect.value);
          const quality = Math.max(10, Math.min(100, parseInt(qualityRange.value,10))) / 100;

          const {blob, dataUrl} = await compressImage(img, target.width, target.height, outputType, quality, file.type);
          const afterBytes = blob.size;

          const name = file.name.replace(/\.(\w+)$/, '') + suffixForType(outputType);

          const card = renderResultCard({
            fileName: name,
            originalType: file.type,
            outputType,
            beforeBytes,
            afterBytes,
            beforeUrl: URL.createObjectURL(file),
            afterUrl: dataUrl,
            blob
          });
          results.prepend(card);
        }catch(err){
          console.error('Compression failed', err);
          alert('Failed to process: '+ file.name);
        }
      }
    }

    function calculateTargetSize(w, h){
      let tw = parseInt(widthInput.value, 10);
      let th = parseInt(heightInput.value, 10);
      if(Number.isNaN(tw)) tw = undefined; if(Number.isNaN(th)) th = undefined;

      if(!tw && !th){ return {width:w, height:h}; }
      if(lockRatio.checked){
        const ratio = w/h;
        if(tw && !th) th = Math.round(tw / ratio);
        if(!tw && th) tw = Math.round(th * ratio);
      } else {
        if(!tw) tw = w; if(!th) th = h;
      }
      return { width: Math.max(1, Math.min(tw, w*4)), height: Math.max(1, Math.min(th, h*4)) };
    }

    function resolveOutputType(originalType, selected){
      if(selected !== 'auto') return selected;
      const supported = ['image/jpeg','image/png','image/webp'];
      return supported.includes(originalType) ? originalType : 'image/jpeg';
    }

    function suffixForType(type){
      if(type.includes('jpeg')) return '.compressed.jpg';
      if(type.includes('png')) return '.compressed.png';
      if(type.includes('webp')) return '.compressed.webp';
      return '.compressed.jpg';
    }

    function loadImage(file){
      return new Promise((resolve, reject)=>{
        const url = URL.createObjectURL(file);
        const img = new Image();
        img.onload = ()=>{
          const data = {img, naturalWidth: img.naturalWidth, naturalHeight: img.naturalHeight};
          URL.revokeObjectURL(url);
          resolve(data);
        };
        img.onerror = reject;
        img.src = url;
      });
    }

    async function compressImage(img, width, height, mime, quality, originalType){
      const canvas = document.createElement('canvas');
      canvas.width = width; canvas.height = height;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0, width, height);

      // GIF: take first frame via canvas draw (already done); transparency for PNG preserved
      const dataUrl = canvas.toDataURL(mime, quality);
      const blob = await (await fetch(dataUrl)).blob();

      // Edge case: if PNG requested but size grew, try JPEG/WebP fallback when original had no alpha
      if(mime === 'image/png'){
        // Heuristic: check alpha by sampling a few pixels
        const hasAlpha = checkAlpha(canvas);
        if(!hasAlpha){
          const altUrl = canvas.toDataURL('image/webp', quality);
          const altBlob = await (await fetch(altUrl)).blob();
          if(altBlob.size < blob.size * 0.85){
            return {blob: altBlob, dataUrl: altUrl};
          }
        }
      }
      return {blob, dataUrl};
    }

    function checkAlpha(canvas){
      const ctx = canvas.getContext('2d');
      const {width, height} = canvas;
      const sample = ctx.getImageData(0, 0, Math.min(32,width), Math.min(32,height)).data;
      for(let i=3;i<sample.length;i+=4){ if(sample[i] < 255) return true; }
      return false;
    }

    function human(bytes){
      if(bytes < 1024) return bytes + ' B';
      const units = ['KB','MB','GB'];
      let i=-1; do { bytes/=1024; i++; } while(bytes>=1024 && i<units.length-1);
      return bytes.toFixed(bytes<10?2:1) + ' ' + units[i];
    }

    function percent(before, after){
      if(before===0) return '0%';
      const saved = Math.max(0, (1 - after/before) * 100);
      return saved.toFixed(1) + '%';
    }

    function renderResultCard({fileName, originalType, outputType, beforeBytes, afterBytes, beforeUrl, afterUrl, blob}){
      const wrap = document.createElement('article');
      wrap.className = 'result';
      wrap.innerHTML = `
        <header>
          <strong title="File name">${escapeHtml(fileName)}</strong>
          <div class="stats" aria-label="Optimization stats">
            <span title="Original size">${human(beforeBytes)}</span>
            <span>‚Üí</span>
            <span title="Compressed size">${human(afterBytes)}</span>
            <span>‚Ä¢ Saved ${percent(beforeBytes, afterBytes)}</span>
          </div>
        </header>
        <div class="preview">
          <figure>
            <img loading="lazy" src="${beforeUrl}" alt="Original image preview" />
            <figcaption class="sr-only">Original (${originalType})</figcaption>
          </figure>
          <figure>
            <img loading="lazy" src="${afterUrl}" alt="Compressed image preview" />
            <figcaption class="sr-only">Compressed (${outputType})</figcaption>
          </figure>
        </div>
        <div class="actions">
          <button class="btn" type="button" aria-label="Download compressed image">Download</button>
          <button class="btn secondary" type="button" aria-label="Compare in new tab">Open Preview</button>
        </div>
      `;

      const [downloadBtn, previewBtn] = wrap.querySelectorAll('.actions button');
      downloadBtn.addEventListener('click', ()=>{
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = fileName;
        document.body.appendChild(a); a.click(); a.remove();
        setTimeout(()=> URL.revokeObjectURL(a.href), 1500);
      });
      previewBtn.addEventListener('click', ()=> window.open(afterUrl, '_blank'));
      return wrap;
    }

    function escapeHtml(s){
      return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c]));
    }

    // ====== Accessibility: keyboard support for dropzone ======
    dropzone.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); fileInput.click(); } });
  </script>

  <!-- Noscript message for SEO and users without JS -->
  <noscript>
    <p style="max-width:60ch;margin:1rem auto;display:block;color:#d7def7;text-align:center">This tool requires JavaScript to compress images directly in your browser. Please enable JavaScript and reload.</p>
  </noscript>
</body>
</html>
